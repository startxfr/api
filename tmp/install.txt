procédure d'installation


1. PREREQUIS

* Apache + php > 5.1 + modules
	php-mcrypt
	php-xml
	php-pear-Log
	php-pear-XML-Parser
	php-common
	php-mbstring
	php-pear
	php-pdo
	php-mysql
	php-ncurses
	php-xmlrpc
* Subversion >= 1.4
* MySql >= 5.0
* phpMyAdmin >= 2.0
* Eclipse IDE  avec module eclipse-phpeclipse et subclipse

2. RECUPERATION DES SOURCES
---------------------------
* Sur le serveur de développement, allez dans le répertoire racine de votre serveur
  internet
>> cd /var/www/html

* créer un sous-répertoire pour installer votre nouvelle instance de zuno et allez dans
  ce répertoire
>> mkdir zuno
>> cd zuno

* Faire un checkout de la dernière version du projet
  ATTENTION: les entrepôts situés sur polaris.startx.fr nécessitent un accès sur un port spécifique.
  Pour atteindre le serveur, vous devez, avant toute communication SVN, exporter la variable suivante:
  >> export SVN_SSH="ssh -p 42867"
>> svn co svn+ssh://xxxx@startx.fr/var/db/svn/SXA2/zunodemo .
  vous devez remplacer "xxxx" par votre nom d'utilisateur

* Changer les permissions sur le répertoire temporaire et image
>> chown apache:apache -R tmp img/page img/page.menu img/imgbank; 
>> chmod ug+rwx  tmp img/page img/page.menu img/imgbank

* Modifier le fichier de configuration conf/general.xml
>> vi conf/general.xml
  - Modifier la ligne 12 (PROJET-mail) et mettre votre adresse mail (pour les copies de mail envoyés)
  - Modifier la ligne 27 (REP-appli) et mettre le chemin absolu vers l'application (ex: /var/www/html/zunodemo/)
    Ne pas oublier le "/" à la fin 
  - Modifier la ligne 41 (URL-Dir) et mettre le chemin contenu dans l'URL du site (ex: zunodemo/ pour http://localhost/zunodemo/)
  - Modifier la ligne 42 (URL-Domain) et mettre le domaine contenu dans l'URL du site (ex: localhost pour http://localhost/zunodemo/)
  - Modifier la ligne 43 (URL-appli) et mettre l'URL du site sans le protocole (ex: localhost/zunodemo/ pour http://localhost/zunodemo/)


3. CREATION DE LA BASE DE DONNEE
---------------------------
* Création de la base de donnée (ex: DEMO_zuno)
>> mysql -h 127.0.0.1 -u root -pmotdepasserootdemysql mysql;
>>> CREATE DATABASE `DEMO_zuno`;

* Création de l'utilisateur de la base de donnée ex: zunodemo (toujours dans un shell Mysql)
>>> CREATE USER 'zunodemo'@'%' IDENTIFIED BY 'zunodemo';
>>> GRANT USAGE ON * . * TO 'zunodemo'@'%' IDENTIFIED BY 'zunodemo' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ;
>>> GRANT ALL PRIVILEGES ON `DEMO\_zuno` . * TO 'zunodemo'@'%' WITH GRANT OPTION ;


* Importation du schema de la base de donnée
>>> EXIT;
>> mysql -h 127.0.0.1 -u zunodemo -pzunodemo --default_character_set utf8 DEMO_zuno  < tmp/sxa.schema.sql;

* Importation des données
>> mysql -h 127.0.0.1 -u zunodemo -pzunodemo --default_character_set utf8 DEMO_zuno  < tmp/sxa.data.sql;

* Importation des exemples
>> mysql -h 127.0.0.1 -u zunodemo -pzunodemo --default_character_set utf8 DEMO_zuno  < tmp/sxa.sample.sql;

* Modifier le fichier de configuration conf/permanent/bdd.xml
>> vi conf/permanent/bdd.xml
  - Modifier la ligne 19 (login) et mettre le login de l'utilisateur mysql
  - Modifier la ligne 20 (pass) et mettre le mot de masse de l'utilisateur mysql
  - Modifier la ligne 21 (base) et mettre le nom de la base mysql


4. INSTALLATION TERMINEE
---------------------------
* Vous pouvez consulter l'application direction sur votre navigateur internet.



5. INSTALLATION DE LA GED
---------------------------
* Vérifier que vous avez un répertoire /var/db/svn valide. Sinon, lancez la commande suivante
>> mkdir /var/db/svn;
* Créer un nouvel entrepôt subversion pour la GED (ex: zunodemoGed)
>> svnadmin create /var/db/svn/zunodemoGed;
* Autoriser apache en lecture/écriture sur ce répertoire
>> chown apache:apache -R /var/db/svn/zunodemoGed; chmod ug+rwx -R /var/db/svn/zunodemoGed; 
* allez dans le répertoire tmp/ de l'application 
>> cd tmp;
* Extraire l'archive zunoGed.tar.gz et se déplacer dans le nouveau répertoire
>> tar xzvf zunoGed.tar.gz; cd zunoGed;
* Lancer l'importation dans le nouvel entrepôt de l'arborescence zunoGed
>> svn import -m "première importation" file:///var/db/svn/zunodemoGed; 
* Nettoyer le répertoire temporaire
>> cd ../;  rm -rf zunoGed zunoGed.tar.gz;
* Se déplacer dans un répertoire accessible par apache, et différent de l'application
>> cd /var/www/html/; 
* créer un répertoire pour recevoir la copie de travail utilisée par l'application
>> mkdir zunoGedWC;
* Importer la copie de travail dans ce répertoire
>>  svn co file:///var/db/svn/zunodemoGed zunoGedWC/;
* Changer les permissions sur ce répertoire pour autoriser apache à lire et écrire
>> chown apache:apache -R zunoGedWC;
* Modifier le fichier de configuration conf/permanent/bdd.xml
>> cd -; cd ..; vi conf/permanent/gnose.xml;
  - Modifier la ligne 17 (WorkCopy) et mettre le chemin absolu vers la copie de travail (ex: /var/www/html/zunoGedWC/)
  - Modifier la ligne 27 (Repository) et mettre le chemin absolu vers l'entrepôt subversion (ex: file:///var/db/svn/zunodemoGed)
* Nettoyer le cache de l'application et Enjoy!!!
>> rm -rf tmp/*
